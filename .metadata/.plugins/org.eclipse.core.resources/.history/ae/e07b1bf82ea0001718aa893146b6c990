import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.util.ArrayList;

public class Main {
	public static void main(String[] args) throws IOException {
		String fileName = "test";
		BufferedReader reader = new BufferedReader(new FileReader(new File(fileName + ".txt")));

		String line;
		String currentSpeaker = "";

		ArrayList<String> output = new ArrayList<String>();

		while ((line = reader.readLine()) != null) {
			if (line.startsWith("[")) {
				currentSpeaker = line.substring(1, line.indexOf("]"));
				currentSpeaker.replaceAll(" ", "_");
			} else {
				String outputLine = "{\n  {\n  ";
				outputLine += currentSpeaker;
				outputLine += ": \'";
				outputLine += line;
				outputLine += "\'\n  }\n}";
				outputLine += ",";
				output.add(outputLine);
			}

		}

		File file = new File(fileName + "_fixed.txt");
		if (!file.exists()) {
			file.createNewFile();
		}

		BufferedWriter writer = new BufferedWriter(new FileWriter(file));
		for (int i = 0; i < output.size(); i++) {
			String s = output.get(i);
			if (i != output.size() - 1) {
				writer.write(s);
				writer.newLine();
			} else {
				s = s.substring(0, s.length() - 1);
				writer.write(s);
			}
		}
		reader.close();
		writer.close();

	}
}
